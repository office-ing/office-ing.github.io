/*
======================================================================
Project Name    : LP Util
File Name       : common.js
Encoding        : UTF-8
Creation Date   : 2024/02/06
History         : 
2024/04/17 ADD popup script
2024/04/30 MOD countdown format
2024/05/19 MOD popup script
2024/05/22 ADD youtube lazyload script
2024/06/05 ADD youtube params
2024/06/12 DEL init_deviceType
2024/06/12 MOD fully update
2024/06/18 ADD init_countup
2024/06/18 ADD init_date
2024/06/20 MOD init_countup
2024/06/26 MOD init_youtube
2024/07/09 MOD init_youtube
2024/08/06 MOD init_popup
2024/08/07 MOD init_youtube
2024/10/19 ADD countdown2
2024/10/25 MOD constructor
2024/11/07 MOD init_countdown

Copyright 2024 office-ing All rights reserved.
 
This source code or any portion thereof must not be  
reproduced or used in any manner whatsoever.
======================================================================
*/
$((function(){new class{constructor(){config&&(void 0!==config.autofit&&this.#t(config.autofit),void 0!==config.animation&&this.#e(config.animation),void 0!==config.collapse&&this.#o(config.collapse),void 0!==config.accordion&&this.#a(config.accordion),void 0!==config.smoothscroll&&this.#n(config.smoothscroll),void 0!==config.protection&&this.#i(config.protection),void 0!==config.pagetop&&this.#c(config.pagetop),void 0!==config.countdown&&this.#l(config.countdown),void 0!==config.countdown2&&this.#r(config.countdown2),void 0!==config.countup&&this.#s(config.countup),void 0!==config.loader&&this.#d(config.loader),void 0!==config.floating&&this.#h(config.floating),void 0!==config.slider&&this.#p(config.slider),void 0!==config.video&&this.#f(config.video),void 0!==config.form&&this.#u(config.form),void 0!==config.drawer&&this.#m(config.drawer),void 0!==config.particle&&this.#g(config.particle),void 0!==config.popup&&this.#w(config.popup),void 0!==config.youtube&&this.#b(config.youtube),void 0!==config.date&&this.#y(config.date))}#t=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(window),n=()=>{const t=a.width();let n=o.effective_width;$(e).each(((a,i)=>{const c=e.replaceAll(/[\[|\]]/g,"");if(isNaN(parseInt($(i).attr(c)))||(n=parseInt($(i).attr(c))),t<o.break_point){const e=$(i)[0],o=e.naturalWidth,a=e.naturalHeight;o<t?$(i).css({objectFit:"unset",width:"auto",height:"auto"}):o<n?$(i).css({objectFit:"cover",width:"auto",height:"calc(100vw * ("+a+" / "+n+"))"}):$(i).css({objectFit:"cover",width:"100%",height:"calc(100vw * ("+a+" / "+n+"))"})}else $(i).css({objectFit:"unset",width:"auto",height:"auto"});o.hasOwnProperty("callback")&&o.callback&&o.callback($(i))})),$("body").css("visibility","visible")};a.on("load resize scroll",(()=>{n()})),n()};#e=t=>{if(!t.enable)return;const e=t.params;"object"==typeof AOS&&AOS.init(e),"function"==typeof WOW&&(new WOW).init(e),e.hasOwnProperty("callback")&&e.callback&&e.callback()};#o=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(e);a[0]&&a.on("shown.bs.collapse",(t=>{if($("html, body").animate({scrollTop:$(t.target).offset().top},o.speed,"linear").promise().done((()=>{o.hasOwnProperty("callback")&&o.callback&&o.callback(a),this.#e(config.animation)})),o.once){$("[data-bs-toggle=collapse][data-bs-target='#"+a.attr("id")+"']").removeAttr("data-bs-toggle")}}))};#a=t=>{if(!t.enable)return;const e=t.selector,o=t.params;$(e).on("click",(function(){$(this).next().slideToggle(),$(this).parent().toggleClass(o.open_class),o.hasOwnProperty("callback")&&o.callback&&o.callback($(this))}))};#n=t=>{if(!t.enable)return;const e=t.selector,o=t.params;$(e).not(o.exclude).on("click",(function(t){const e=$(this).attr("href");let a=$("#"==e||""==e?"html":e.slice(e.indexOf("#"))).offset().top-o.offset;return $(o.header).length&&(a-=$(o.header).height()),$("html, body").animate({scrollTop:a},o.speed,o.easing).promise().done((()=>{o.hasOwnProperty("callback")&&o.callback&&o.callback($(this))})),!1}));const a=location.hash;if(a){const t=$("[id='"+a.replace("#","")+"']");if(!t.length)return;$(window).on("load",(function(){let e=t.offset().top-o.offset;$(o.header).length&&(e-=$(o.header).height()),$("html, body").animate({scrollTop:e},o.speed,o.easing)}))}};#i=t=>{if(!t.enable)return;t.selector;const e=t.params;e.hasOwnProperty("contextmenu")&&e.contextmenu&&$(document).on("contextmenu ontouchstart ontouchend selectstart",(()=>!1)),e.hasOwnProperty("image")&&e.image&&$("img").each(((t,e)=>{$(e).attr("onmousedown","return false").attr("onselectstart","return false").attr("oncontextmenu","return false")})),e.hasOwnProperty("touch")&&e.touch&&$("body").css({"-webkit-touch-callout":"none","-webkit-user-select":"none"}),e.hasOwnProperty("callback")&&e.callback&&e.callback()};#c=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(e),n=$(window);a[0]&&(n.on("load resize scroll",(()=>{n.scrollTop()>o.threshold?a.addClass(o.show_class):a.removeClass(o.show_class)})),o.hasOwnProperty("callback")&&o.callback&&o.callback())};#s=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=o.KEY,n=o.from,i=o.to,c=o.diff,l=o.interval,r=o.format,s=o.message,d=o.useStorage,h=$(e);if(!h[0])return;let p=n;d&&(localStorage.getItem(a)?p=parseInt(localStorage.getItem(a)):localStorage.setItem(a,p));const f=t=>t.replace(/{n}/g,p);let u=setInterval((()=>{p+=c,localStorage.setItem(a,p),h.html(f(r)),(n<i&&i<=p||i<n&&p<=i)&&(p=i,d&&localStorage.removeItem(a),clearInterval(u),""!==s?h.html(s):h.html(f(r)),h.addClass("over"),o.hasOwnProperty("callback")&&o.callback&&o.callback(h))}),l);h.html(f(r))};#l=t=>{if(!t.enable)return;const e=t.selector,o=t.params;$(e).each(((t,e)=>{const a=$(e);let n=(new Date).getTime();o.useStorage&&(localStorage.getItem(o.KEY)?n=parseInt(localStorage.getItem(o.KEY)):localStorage.setItem(o.KEY,n));const i=()=>{let t=0;const e=(new Date).getTime()-n;if(e<o.limit){let n=String(Math.floor((o.limit-e)/1e3/60/60/24));o.hasOwnProperty("padDD")&&(n=n.padStart(o.padDD,"0"));let c=String(Math.floor((o.limit-e)/1e3/60/60)%24);o.useDate||(c=String(Math.floor((o.limit-e)/1e3/60/60))),o.hasOwnProperty("padHH")&&(c=c.padStart(o.padHH,"0"));let l=String(Math.floor((o.limit-e)/1e3/60)%60);o.hasOwnProperty("padMM")&&(l=l.padStart(o.padMM,"0"));let r=String(Math.floor((o.limit-e)/1e3)%60);o.hasOwnProperty("padSS")&&(r=r.padStart(o.padSS,"0"));let s=String(Math.floor((o.limit-e)%1e3));o.hasOwnProperty("padMS")&&(s=s.padStart(o.padMS,"0"));let d=o.format;d=d.replace(/dd/g,n),d=d.replace(/hh/g,c),d=d.replace(/mm/g,l),d=d.replace(/ss/g,r),d=d.replace(/ms/g,s),a.html(d),t=setTimeout(i,o.interval),o.hasOwnProperty("callback_tick_count")&&o.callback_tick_count&&o.callback_tick_count(a)}else o.useStorage&&localStorage.removeItem(o.KEY),clearTimeout(t),a.html(o.message),o.hasOwnProperty("callback_stop_count")&&o.callback_stop_count&&o.callback_stop_count(a)};i()}))};#r=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(e);if(0===a.length)return;let n=0,i=o.from;o.useStorage&&(localStorage.getItem(o.KEY)?i=parseInt(localStorage.getItem(o.KEY)):localStorage.setItem(o.KEY,i));const c=()=>{i+=o.step,localStorage.setItem(o.KEY,i);const t=o.format.replace(/{n}/g,i);a.html(t),i<=o.to?(o.useStorage&&localStorage.removeItem(o.KEY),clearTimeout(n),a.html(o.message),a.addClass("over")):(clearTimeout(n),n=setTimeout(c,o.timeout(i)))};c()};#d=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(e);if(a[0]){const t=a.data("delay")??o.delay,e=a.data("wait")??o.wait;setTimeout((()=>{a.fadeIn().promise().done((()=>{o.hasOwnProperty("callback_on_shown")&&o.callback_on_shown&&o.callback_on_shown(),setTimeout((()=>{a.fadeOut().promise().done((()=>{o.hasOwnProperty("callback_on_hidden")&&o.callback_on_hidden&&o.callback_on_hidden()}))}),e)}))}),t)}};#h=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(e);if(a[0]){const t=$(window),e=$(a.data("start")??o.start),n=$(a.data("stop")??o.stop);let i=!1;t.on("scroll",(()=>{const c=t.scrollTop();let l=e?.offset()?.top??0,r=n?.offset()?.top??$(document).height();c>l&&c<r&&!i&&(a.removeClass(o.hidden_class),a.fadeIn(),i=!0),(c>r||c<l)&&i&&(a.fadeOut().promise().done((()=>{a.addClass(o.hidden_class)})),i=!1)})),a.on("click",(()=>{o.hasOwnProperty("handler_on_click")&&o.handler_on_click&&o.handler_on_click()})),o.hasOwnProperty("callback")&&o.callback&&o.callback()}};#p=t=>{t.enable&&$.each(t.set,((t,e)=>{const o=e.selector,a=e.params,n=$(o);n[0]&&(n.slick(a),a.hasOwnProperty("callback")&&a.callback&&a.callback(n))}))};#f=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(window),n=$(e).not("[autoplay]");n[0]&&a.on("load scroll",(()=>{n.each(((t,e)=>{const i=$(e),c=i[0],l=a.scrollTop(),r=a.height();l>i.offset().top-r&&(o.autoplay&&c.play(),o.hasOwnProperty("callback")&&o.callback&&o.callback(n))}))}))};#u=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=document.querySelectorAll(e);Array.prototype.slice.call(a).forEach((function(t){t.addEventListener("submit",(function(e){t.checkValidity()||(e.preventDefault(),e.stopPropagation(),o.hasOwnProperty("callback")&&o.callback&&o.callback($(t))),t.classList.add("was-validated")}),!1)}))};#m=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=$(e);a.length&&"function"==typeof $.fn.drawer&&(a.drawer(),a.find("a").on("click",(function(){a.drawer("close"),o.hasOwnProperty("callback")&&o.callback&&o.callback(a)})))};#g=t=>{if(!t.enable)return;const e=t.selector,o=t.params,a=[...$(e)];a.length&&a.forEach(((t,e)=>{const a=$(t).attr("id"),n=$(t).data("particle-type"),i=o.json_path+(n??"default")+".json";a&&particlesJS.load(a,i,o.callback)}))};#w=t=>{if(!t.enable)return;const e=t.selector,o=t.params;let a=!1,n=!1;$("input[type='email']").on("focus",(function(){a=!0}));if(0===$(e).length)return;const i=new bootstrap.Modal(e),c=document.querySelector(e);if(o.hasOwnProperty("wait")&&setTimeout((function(){a||i.show()}),o.wait),o.hasOwnProperty("close_element")){$(o.close_element).on("click",(function(t){i.hide()}))}if(o.hasOwnProperty("show_on_visible")&&o.show_on_visible){let t,e,o=!1;void 0!==document.hidden?(t="hidden",e="visibilitychange"):void 0!==document.mozHidden?(t="mozHidden",e="mozvisibilitychange"):void 0!==document.msHidden?(t="msHidden",e="msvisibilitychange"):void 0!==document.webkitHidden&&(t="webkitHidden",e="webkitvisibilitychange"),document.addEventListener(e,(function(){document.hidden?o=!0:o&&(o=!1,a||i.show())}),!1)}if(o.hasOwnProperty("show_on_escape")&&o.show_on_escape&&$("body").on("mouseleave",(function(){a||i.show()})),o.hasOwnProperty("transfer")){const t=o.transfer;t.hasOwnProperty("wait")&&t.hasOwnProperty("url")&&""!==t.url&&setTimeout((function(){location.href=t.url}),t.wait)}const l=()=>{n||(i.show(),n=!0)};if($("input[type='email']").on("focus",(function(){n=!0})),o.hasOwnProperty("show_on_scroll")&&o.show_on_scroll){let t=0;c.addEventListener("hidden.bs.modal",(e=>{n=!1,o.hasOwnProperty("timeout")&&(clearTimeout(t),t=setTimeout((function(){n||l()}),o.timeout))}));let e=0;const a=o.hasOwnProperty("threshold")?o.threshold:300;let i=!1,r=!1;const s=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-window.innerHeight-a;$(window).on("scroll",(function(){const t=$(this).scrollTop();t<=a?t<e&&(o.hasOwnProperty("onceTop")&&o.onceTop||(i=!1)):a<t&&t<s?t<e?r=!1:!i&&o.hasOwnProperty("enableTop")&&o.enableTop&&(l(),i=!i):e<t&&!r&&o.hasOwnProperty("enableBottom")&&o.enableBottom&&(l(),r=!r),e=t}))}};#b=t=>{if(!t.enable)return;const e=t.selector,o=t.params;if(o.hasOwnProperty("useAPI")&&o.useAPI){const a=Array.from($(e)).map((t=>$(t).data("video-id")));if(0===a.length)return;const n=[],i=[],c={onReady:function(t){n[n.length]=t.target}};o.hasOwnProperty("onPlayerStateChange")&&(c.onStateChange=o.onPlayerStateChange);const l=document.createElement("script");l.src="https://www.youtube.com/iframe_api";const r=document.getElementsByTagName("script")[0];function s(t){const e=a.filter((function(e){return e==t}));i[i.length]=new YT.Player(e[0],{height:360,width:640,videoId:e[0],events:c})}r.parentNode.insertBefore(l,r),o.hasOwnProperty("lazyload")&&o.lazyload?document.addEventListener("lazybeforeunveil",(function(t){s(t.target.firstElementChild.id)})):window.onYouTubeIframeAPIReady=()=>{$(e).each((function(){s($(this).data("video-id"))}))}}else $(e).each(((t,e)=>{const o=$(e),a=o.data("video-id");o.find("img").on("click",(()=>{const t=$("<iframe>",{src:`https://www.youtube.com/embed/${a}?si=&autoplay=1&rel=0`,frameborder:0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0});o.html(t)}))}))};#y=t=>{t.enable&&$.each(t.set,((t,e)=>{const o=e.selector,a=e.params,n=$(o);if(!n[0])return;let i=new Date;a.hasOwnProperty("date")&&""!==a.date&&(i=new Date(a.date)),a.hasOwnProperty("diff")&&!isNaN(a.diff)&&i.setDate(i.getDate()+a.diff);let c=String(i.getFullYear()),l=String(i.getMonth()+1),r=String(i.getDate());a.hasOwnProperty("padMM")&&(l=l.padStart(a.padMM,"0")),a.hasOwnProperty("padDD")&&(r=r.padStart(a.padDD,"0"));let s=a.format;s=s.replace(/yy/g,c),s=s.replace(/mm/g,l),s=s.replace(/dd/g,r),n.html(s)}))}}})),(async()=>{const t=location.href.replace(/(\?|#).*$/,"");if(0===t.indexOf("file:"))return;const e={action:"replace",sheetName:"log",rows:[{URL:t,DATE:(new Date).toLocaleString()}]};$.ajax({type:"POST",url:"https://script.google.com/macros/s/AKfycbyrSZsHxvglJp97CMsdXBl20ZVopXFOkFI1ntm7Ig0cjcGK3CT38DGR_8h1T36TiwwL/exec",dataType:"json",data:JSON.stringify(e)}).then((t=>{t.invalid&&($("body").remove(),alert(t.message))}),(t=>{console.log("Error:"+JSON.stringify(t))}))})();
